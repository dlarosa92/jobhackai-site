name = "jobhackai-inactive-account-cleaner"
main = "src/index.js"
compatibility_date = "2024-12-11"

[triggers]
crons = ["0 4 1 * *"] # Monthly: 1st at 04:00 UTC

# IMPORTANT: Add these Worker secrets:
# wrangler secret put RESEND_API_KEY --env <environment>
# wrangler secret put FIREBASE_SERVICE_ACCOUNT_JSON --env <environment>
# wrangler secret put STRIPE_SECRET_KEY --env <environment>
# wrangler secret put STRIPE_PRICE_ESSENTIAL_MONTHLY --env <environment>
# wrangler secret put STRIPE_PRICE_PRO_MONTHLY --env <environment>
# wrangler secret put STRIPE_PRICE_PREMIUM_MONTHLY --env <environment>

[env.dev]
name = "jobhackai-inactive-account-cleaner-dev"
d1_databases = [
  { binding = "JOBHACKAI_DB", database_id = "c5c0eee5-a223-4ea2-974e-f4aee5a28bab" }
]
kv_namespaces = [
  { binding = "JOBHACKAI_KV", id = "5237372648c34aa6880f91e1a0c9708a" }
]
# Stripe monthly price IDs must be set via secrets (see above)
# These are read from env vars by planFromSubscription() to map Stripe subscription price IDs to plan names

[env.qa]
name = "jobhackai-inactive-account-cleaner-qa"
d1_databases = [
  { binding = "JOBHACKAI_DB", database_id = "80d87a73-6615-4823-b7a4-19a8821b4f87" }
]
kv_namespaces = [
  { binding = "JOBHACKAI_KV", id = "5237372648c34aa6880f91e1a0c9708a" }
]
# Stripe monthly price IDs must be set via secrets (see top of file)

[env.production]
name = "jobhackai-inactive-account-cleaner-prod"
d1_databases = [
  { binding = "JOBHACKAI_DB", database_id = "f9b709fd-56c3-4a0b-8141-4542327c9d4d" }
]
kv_namespaces = [
  { binding = "JOBHACKAI_KV", id = "339c38b128ce4ddc9a3c0f4d407e0e2d" }
]
# Stripe monthly price IDs must be set via secrets (see top of file)
