<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Navigation Test - JobHackAI</title>
  <link rel="stylesheet" href="css/tokens.css" />
  <link rel="stylesheet" href="css/reset.css" />
  <link rel="stylesheet" href="css/main.css" />
  <link rel="stylesheet" href="css/header.css" />
  <link rel="stylesheet" href="css/footer.css" />
</head>
<body>
  <!-- Header -->
  <header class="site-header">
    <div class="container">
      <a href="index.html" class="nav-logo" aria-label="Go to homepage">
        <svg width="24" height="24" fill="none" stroke="#1F2937" stroke-width="2" xmlns="http://www.w3.org/2000/svg">
          <rect x="3" y="7" width="18" height="13" rx="2"/>
          <path d="M8 7V5a2 2 0 012-2h4a2 2 0 012 2v2"/>
        </svg>
        <span>JOBHACKAI</span>
      </a>
      <div class="nav-group">
        <nav class="nav-links" role="navigation">
          <!-- Navigation will be dynamically populated by navigation.js -->
        </nav>
      </div>
      <button class="mobile-toggle" aria-label="Open navigation menu" aria-expanded="false" aria-controls="mobileNav">
        <svg width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
          <line x1="3" y1="12" x2="21" y2="12"></line>
          <line x1="3" y1="6" x2="21" y2="6"></line>
          <line x1="3" y1="18" x2="21" y2="18"></line>
        </svg>
      </button>
    </div>
  </header>

  <nav class="mobile-nav" id="mobileNav">
    <!-- Mobile navigation will be dynamically populated by navigation.js -->
  </nav>

  <main style="padding: 2rem; max-width: 800px; margin: 0 auto;">
    <h1>Navigation Test Page</h1>
    
    <div style="background: #f5f5f5; padding: 1rem; border-radius: 8px; margin: 1rem 0;">
      <h3>Current State:</h3>
      <div id="current-state">Loading...</div>
    </div>
    
    <div style="background: #f5f5f5; padding: 1rem; border-radius: 8px; margin: 1rem 0;">
      <h3>Test Controls:</h3>
      <button onclick="testVisitor()">Test Visitor Navigation</button>
      <button onclick="testFree()">Test Free User</button>
      <button onclick="testTrial()">Test Trial User</button>
      <button onclick="clearAll()">Clear All</button>
    </div>
    
    <div style="background: #f5f5f5; padding: 1rem; border-radius: 8px; margin: 1rem 0;">
      <h3>Debug Info:</h3>
      <div id="debug-info">Loading...</div>
    </div>
  </main>

  <script src="js/navigation.js"></script>
  <script>
    function updateDebugInfo() {
      const stateDiv = document.getElementById('current-state');
      const debugDiv = document.getElementById('debug-info');
      
      if (window.JobHackAINavigation) {
        const authState = window.JobHackAINavigation.getAuthState();
        const currentPlan = window.JobHackAINavigation.getEffectivePlan();
        
        stateDiv.innerHTML = `
          <p><strong>Authenticated:</strong> ${authState.isAuthenticated}</p>
          <p><strong>User Plan:</strong> ${authState.userPlan || 'none'}</p>
          <p><strong>Effective Plan:</strong> ${currentPlan}</p>
          <p><strong>localStorage:</strong></p>
          <ul>
            <li>user-authenticated: ${localStorage.getItem('user-authenticated')}</li>
            <li>user-plan: ${localStorage.getItem('user-plan')}</li>
            <li>dev-plan: ${localStorage.getItem('dev-plan')}</li>
          </ul>
        `;
        
        debugDiv.innerHTML = `
          <p><strong>Navigation Config:</strong> ${JSON.stringify(window.JobHackAINavigation.NAVIGATION_CONFIG[currentPlan]?.navItems?.map(item => item.text), null, 2)}</p>
          <p><strong>Has CTA:</strong> ${!!window.JobHackAINavigation.NAVIGATION_CONFIG[currentPlan]?.cta}</p>
        `;
      } else {
        stateDiv.innerHTML = '<p>Navigation system not loaded</p>';
        debugDiv.innerHTML = '<p>Navigation system not loaded</p>';
      }
    }
    
    function testVisitor() {
      localStorage.clear();
      localStorage.setItem('user-authenticated', 'false');
      localStorage.setItem('user-plan', 'free');
      localStorage.setItem('dev-plan', 'visitor');
      window.location.reload();
    }
    
    function testFree() {
      localStorage.setItem('user-authenticated', 'true');
      localStorage.setItem('user-plan', 'free');
      localStorage.setItem('dev-plan', 'free');
      window.location.reload();
    }
    
    function testTrial() {
      localStorage.setItem('user-authenticated', 'true');
      localStorage.setItem('user-plan', 'trial');
      localStorage.setItem('dev-plan', 'trial');
      window.location.reload();
    }
    
    function clearAll() {
      localStorage.clear();
      window.location.reload();
    }
    
    // Initialize when navigation is ready
    if (window.JobHackAINavigation && typeof window.JobHackAINavigation.initializeNavigation === 'function') {
      window.JobHackAINavigation.initializeNavigation();
      setTimeout(updateDebugInfo, 500);
    } else {
      window.addEventListener('DOMContentLoaded', function() {
        if (window.JobHackAINavigation && typeof window.JobHackAINavigation.initializeNavigation === 'function') {
          window.JobHackAINavigation.initializeNavigation();
          setTimeout(updateDebugInfo, 500);
        }
      });
    }
    
    // Update debug info periodically
    setInterval(updateDebugInfo, 2000);
  </script>
</body>
</html>
